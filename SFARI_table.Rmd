```{r}
# 必要なライブラリ
library(tidyverse)

# SFARI gene listの読み込み
sfari_genes <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv") # 必要に応じて適切なファイルパスに変更
# OxiDIP-seqおよびGlyDIP-seqのデータを読み込み
oxiseq_genes <- read.csv("oxidip_gene.csv") # 必要に応じて変更
glyseq_genes <- read.csv("glydip_gene.csv") # 必要に応じて変更

# 必要な列を確認
head(sfari_genes)
head(oxiseq_genes)
head(glyseq_genes)

```


```{r}
# SFARIスコアを1～5に分類
sfari_genes <- sfari_genes %>%
  mutate(SFARI_score = as.factor(SFARI_score)) # スコア列の名前は実データに合わせて変更

# 各スコアでOxi/Glyポジティブ遺伝子をカウント
sfari_with_signals <- sfari_genes %>%  # 修正: sfari.genes -> sfari_genes
  mutate(
    Oxi_posi = ifelse(Gene %in% oxiseq_genes$Gene, 1, 0),
    Gly_posi = ifelse(Gene %in% glyseq_genes$Gene, 1, 0)
  ) %>%
  group_by(SFARI_score) %>%
  summarise(
    Total_genes = n(),
    Oxi_count = sum(Oxi_posi),
    Gly_count = sum(Gly_posi)
  )
```


```{r}
# oxidip_gene.csvを読み込む
data <- read.csv("glydip_gene.csv")

# "SYMBOL"列に基づいて重複を削除（最初の出現を残す）
data_unique <- data[!duplicated(data$SYMBOL), ]

# 結果を保存
write.csv(data_unique, "glydip_gene_unique.csv", row.names = FALSE)

```



```{r}
# 必要なライブラリをインストール＆読み込み
library(VennDiagram)


# データの読み込み
oxidip_gene <- read.csv("oxidip_gene.csv")
sfari_gene <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv")

# "SYMBOL"列を抽出
oxidip_symbols <- unique(oxidip_gene$SYMBOL)
sfari_symbols <- unique(sfari_gene$SYMBOL)

# 重複しているSYMBOLを取得
common_symbols <- intersect(oxidip_symbols, sfari_symbols)

# 重複しているSYMBOLをCSVで保存
oxidip_common_symbols_df <- data.frame(SYMBOL = common_symbols)
write.csv(oxidip_common_symbols_df, "OxiDIP_common_symbols.csv", row.names = FALSE)

# ベン図を作成
venn.plot <- draw.pairwise.venn(
  area1 = length(oxidip_symbols),
  area2 = length(sfari_symbols),
  cross.area = length(common_symbols),
  category = c("Oxidip", "SFARI"),
  fill = c("blue", "green")
)

# プロットの表示
grid.newpage()
grid.draw(venn.plot)

```


```{r}
# 必要なライブラリをインストール＆読み込み
library(VennDiagram)


# データの読み込み
oxidip_gene <- read.csv("glydip_gene.csv")
sfari_gene <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv")

# "SYMBOL"列を抽出
oxidip_symbols <- unique(oxidip_gene$SYMBOL)
sfari_symbols <- unique(sfari_gene$SYMBOL)

# 重複しているSYMBOLを取得
common_symbols <- intersect(oxidip_symbols, sfari_symbols)

# 重複しているSYMBOLをCSVで保存
glydip_common_symbols_df <- data.frame(SYMBOL = common_symbols)
write.csv(glydip_common_symbols_df, "GlyDIP_common_symbols.csv", row.names = FALSE)

# ベン図を作成
venn.plot <- draw.pairwise.venn(
  area1 = length(oxidip_symbols),
  area2 = length(sfari_symbols),
  cross.area = length(common_symbols),
  category = c("GlyDIP", "SFARI"),
  fill = c("blue", "green")
)

# プロットの表示
grid.newpage()
grid.draw(venn.plot)
```

```{r}
# 必要なライブラリをインストール＆読み込み
library(VennDiagram)


# データの読み込み
oxidip_gene <- read.csv("OxiDIP_common_symbols.csv")
sfari_gene <- read.csv("GlyDIP_common_symbols.csv")

# "SYMBOL"列を抽出
oxidip_symbols <- unique(oxidip_gene$SYMBOL)
sfari_symbols <- unique(sfari_gene$SYMBOL)

# 重複しているSYMBOLを取得
common_symbols <- intersect(oxidip_symbols, sfari_symbols)

# 重複しているSYMBOLをCSVで保存
common_symbols_df <- data.frame(SYMBOL = common_symbols)
write.csv(common_symbols_df, "common_symbols.csv", row.names = FALSE)

# ベン図を作成
venn.plot <- draw.pairwise.venn(
  area1 = length(oxidip_symbols),
  area2 = length(sfari_symbols),
  cross.area = length(common_symbols),
  category = c("Oxidip and SFARI", "GlyDIP and SFARI"),
  fill = c("blue", "green")
)

# プロットの表示
grid.newpage()
grid.draw(venn.plot)
```

```{r}
# 必要なライブラリをインストール＆読み込み
if (!requireNamespace("VennDiagram", quietly = TRUE)) {
  install.packages("VennDiagram")
}
library(VennDiagram)

# データの読み込み
oxidip_gene <- read.csv("oxidip_gene.csv")
glydip_gene <- read.csv("glydip_gene.csv")
sfari_gene <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv")

# "SYMBOL"列を抽出してユニークにする
oxidip_symbols <- unique(oxidip_gene$SYMBOL)
glydip_symbols <- unique(glydip_gene$SYMBOL)
sfari_symbols <- unique(sfari_gene$SYMBOL)

# ベン図を作成
venn.plot <- draw.triple.venn(
  area1 = length(oxidip_symbols),
  area2 = length(glydip_symbols),
  area3 = length(sfari_symbols),
  n12 = length(intersect(oxidip_symbols, glydip_symbols)),
  n23 = length(intersect(glydip_symbols, sfari_symbols)),
  n13 = length(intersect(oxidip_symbols, sfari_symbols)),
  n123 = length(intersect(intersect(oxidip_symbols, glydip_symbols), sfari_symbols)),
  category = c("Oxidip Genes", "Glydip Genes", "SFARI Genes"),
  fill = c("blue", "green", "red")
)

# プロットの表示
grid.newpage()
grid.draw(venn.plot)

# PDFで保存
pdf("VennDiagram_ThreeSets.pdf", width = 8, height = 6)  # 必要に応じてサイズを調整
grid.draw(venn.plot)
dev.off()
```








```{r}
# データの読み込み
oxidip_gene <- read.csv("oxidip_gene.csv")
sfari_gene <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv")

# "SYMBOL"列の共通部分を抽出
common_symbols <- intersect(oxidip_gene$SYMBOL, sfari_gene$SYMBOL)

# 共通部分をSFARIデータから抽出
common_sfari <- sfari_gene[sfari_gene$SYMBOL %in% common_symbols, ]

# "SFARI_score"列ごとに集計
sfari_score_counts <- table(common_sfari$SFARI_score)

# 集計結果をデータフレームに変換
sfari_score_oxidip_summary <- as.data.frame(sfari_score_counts)
colnames(sfari_score_summary) <- c("SFARI_score", "Count")

# 結果を表示
print(sfari_score_oxidip_summary)

# 必要ならCSVに保存
write.csv(sfari_score_oxidip_summary, "SFARI_score_oxidip_summary.csv", row.names = FALSE)

```

```{r}
# データの読み込み
oxidip_gene <- read.csv("glydip_gene.csv")
sfari_gene <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv")

# "SYMBOL"列の共通部分を抽出
common_symbols <- intersect(oxidip_gene$SYMBOL, sfari_gene$SYMBOL)

# 共通部分をSFARIデータから抽出
common_sfari <- sfari_gene[sfari_gene$SYMBOL %in% common_symbols, ]

# "SFARI_score"列ごとに集計
sfari_score_counts <- table(common_sfari$SFARI_score)

# 集計結果をデータフレームに変換
sfari_score_glydip_summary <- as.data.frame(sfari_score_counts)
colnames(sfari_score_summary) <- c("SFARI_score", "Count")

# 結果を表示
print(sfari_score_glydip_summary)

# 必要ならCSVに保存
write.csv(sfari_score_glydip_summary, "SFARI_score_glydip_summary.csv", row.names = FALSE)
```



```{r}
# 必要なライブラリ
library(tidyverse)

# SFARI gene listの読み込み
sfari_genes <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv") # 必要に応じて適切なファイルパスに変更
# OxiDIP-seqおよびGlyDIP-seqのデータを読み込み
oxiseq_genes <- read.csv("oxidip_DE_genes.csv") # 必要に応じて変更
glyseq_genes <- read.csv("glydip_DE_genes.csv") # 必要に応じて変更

# 必要な列を確認
head(sfari_genes)
head(oxiseq_genes)
head(glyseq_genes)

```


```{r}
# SFARIスコアを1～5に分類
sfari_genes <- sfari_genes %>%
  mutate(SFARI_score = as.factor(SFARI_score)) # スコア列の名前は実データに合わせて変更

# 各スコアでOxi/Glyポジティブ遺伝子をカウント
sfari_with_signals <- sfari_genes %>%  # 修正: sfari.genes -> sfari_genes
  mutate(
    Oxi_posi = ifelse(Gene %in% oxiseq_genes$Gene, 1, 0),
    Gly_posi = ifelse(Gene %in% glyseq_genes$Gene, 1, 0)
  ) %>%
  group_by(SFARI_score) %>%
  summarise(
    Total_genes = n(),
    Oxi_count = sum(Oxi_posi),
    Gly_count = sum(Gly_posi)
  )
```



```{r}
# oxidip_gene.csvを読み込む
data <- read.csv("glydip_DE_genes.csv")

# "SYMBOL"列に基づいて重複を削除（最初の出現を残す）
data_unique <- data[!duplicated(data$SYMBOL), ]

# 結果を保存
write.csv(data_unique, "glydip_DE_gene_unique.csv", row.names = FALSE)

```



```{r}
# 必要なライブラリをインストール＆読み込み
library(VennDiagram)


# データの読み込み
oxidip_gene <- read.csv("oxidip_DE_gene_unique.csv")
sfari_gene <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv")

# "SYMBOL"列を抽出
oxidip_symbols <- unique(oxidip_gene$SYMBOL)
sfari_symbols <- unique(sfari_gene$SYMBOL)

# 重複しているSYMBOLを取得
common_symbols <- intersect(oxidip_symbols, sfari_symbols)

# 重複しているSYMBOLをCSVで保存
oxidip_common_symbols_df <- data.frame(SYMBOL = common_symbols)
write.csv(oxidip_common_symbols_df, "OxiDIP_DE_common_symbols.csv", row.names = FALSE)

# ベン図を作成
venn.plot <- draw.pairwise.venn(
  area1 = length(oxidip_symbols),
  area2 = length(sfari_symbols),
  cross.area = length(common_symbols),
  category = c("Oxidip", "SFARI"),
  fill = c("blue", "green")
)

# プロットの表示
grid.newpage()
grid.draw(venn.plot)

```


```{r}
# 必要なライブラリをインストール＆読み込み
library(VennDiagram)


# データの読み込み
oxidip_gene <- read.csv("glydip_DE_gene_unique.csv")
sfari_gene <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv")

# "SYMBOL"列を抽出
oxidip_symbols <- unique(oxidip_gene$SYMBOL)
sfari_symbols <- unique(sfari_gene$SYMBOL)

# 重複しているSYMBOLを取得
common_symbols <- intersect(oxidip_symbols, sfari_symbols)

# 重複しているSYMBOLをCSVで保存
glydip_common_symbols_df <- data.frame(SYMBOL = common_symbols)
write.csv(glydip_common_symbols_df, "GlyDIP_DE_common_symbols.csv", row.names = FALSE)

# ベン図を作成
venn.plot <- draw.pairwise.venn(
  area1 = length(oxidip_symbols),
  area2 = length(sfari_symbols),
  cross.area = length(common_symbols),
  category = c("GlyDIP", "SFARI"),
  fill = c("blue", "green")
)

# プロットの表示
grid.newpage()
grid.draw(venn.plot)
```

```{r}
# 必要なライブラリをインストール＆読み込み
library(VennDiagram)


# データの読み込み
oxidip_gene <- read.csv("OxiDIP_DE_common_symbols.csv")
sfari_gene <- read.csv("GlyDIP_DE_common_symbols.csv")

# "SYMBOL"列を抽出
oxidip_symbols <- unique(oxidip_gene$SYMBOL)
sfari_symbols <- unique(sfari_gene$SYMBOL)

# 重複しているSYMBOLを取得
common_symbols <- intersect(oxidip_symbols, sfari_symbols)

# 重複しているSYMBOLをCSVで保存
common_symbols_df <- data.frame(SYMBOL = common_symbols)
write.csv(common_symbols_df, "common_symbols.csv", row.names = FALSE)

# ベン図を作成
venn.plot <- draw.pairwise.venn(
  area1 = length(oxidip_symbols),
  area2 = length(sfari_symbols),
  cross.area = length(common_symbols),
  category = c("Oxidip and SFARI", "GlyDIP and SFARI"),
  fill = c("blue", "green")
)

# プロットの表示
grid.newpage()
grid.draw(venn.plot)
```

```{r}
# 必要なライブラリをインストール＆読み込み
if (!requireNamespace("VennDiagram", quietly = TRUE)) {
  install.packages("VennDiagram")
}
library(VennDiagram)

# データの読み込み
oxidip_gene <- read.csv("oxidip_DE_genes.csv")
glydip_gene <- read.csv("glydip_DE_genes.csv")
sfari_gene <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv")

# "SYMBOL"列を抽出してユニークにする
oxidip_symbols <- unique(oxidip_gene$SYMBOL)
glydip_symbols <- unique(glydip_gene$SYMBOL)
sfari_symbols <- unique(sfari_gene$SYMBOL)

# ベン図を作成
venn.plot <- draw.triple.venn(
  area1 = length(oxidip_symbols),
  area2 = length(glydip_symbols),
  area3 = length(sfari_symbols),
  n12 = length(intersect(oxidip_symbols, glydip_symbols)),
  n23 = length(intersect(glydip_symbols, sfari_symbols)),
  n13 = length(intersect(oxidip_symbols, sfari_symbols)),
  n123 = length(intersect(intersect(oxidip_symbols, glydip_symbols), sfari_symbols)),
  category = c("Oxidip Genes", "Glydip Genes", "SFARI Genes"),
  fill = c("blue", "green", "red")
)

# プロットの表示
grid.newpage()
grid.draw(venn.plot)

# PDFで保存
pdf("VennDiagram_ThreeSets_DE.pdf", width = 8, height = 6)  # 必要に応じてサイズを調整
grid.draw(venn.plot)
dev.off()

```



```{r}
# データの読み込み
oxidip_gene <- read.csv("glydip_DE_genes.csv")
sfari_gene <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv")

# "SYMBOL"列の共通部分を抽出
common_symbols <- intersect(oxidip_gene$SYMBOL, sfari_gene$SYMBOL)

# 共通部分をSFARIデータから抽出
common_sfari <- sfari_gene[sfari_gene$SYMBOL %in% common_symbols, ]

# "SFARI_score"列ごとに集計
sfari_score_counts <- table(common_sfari$SFARI_score)

# 集計結果をデータフレームに変換
sfari_score_glydip_summary <- as.data.frame(sfari_score_counts)
colnames(sfari_score_summary) <- c("SFARI_score", "Count")

# 結果を表示
print(sfari_score_glydip_summary)

# 必要ならCSVに保存
write.csv(sfari_score_glydip_summary, "SFARI_score_glydip_DE_summary.csv", row.names = FALSE)
```
```{r}
# データの読み込み
oxidip_gene <- read.csv("oxidip_DE_genes.csv")
sfari_gene <- read.csv("SFARI-Gene_genes_01-13-2025release_01-23-2025export.csv")

# "SYMBOL"列の共通部分を抽出
common_symbols <- intersect(oxidip_gene$SYMBOL, sfari_gene$SYMBOL)

# 共通部分をSFARIデータから抽出
common_sfari <- sfari_gene[sfari_gene$SYMBOL %in% common_symbols, ]

# "SFARI_score"列ごとに集計
sfari_score_counts <- table(common_sfari$SFARI_score)

# 集計結果をデータフレームに変換
sfari_score_glydip_summary <- as.data.frame(sfari_score_counts)
colnames(sfari_score_summary) <- c("SFARI_score", "Count")

# 結果を表示
print(sfari_score_glydip_summary)

# 必要ならCSVに保存
write.csv(sfari_score_glydip_summary, "SFARI_score_oxidip_DE_summary.csv", row.names = FALSE)
```


```{r}
# データの読み込み
glydip_info <- read.csv("glydip_DE_genes.csv")
glydip_common <- read.csv("GlyDIP_DE_common_symbols.csv")

# "SYMBOL"列をユニークに抽出
common_symbols <- unique(glydip_common$SYMBOL)

# 一致するSYMBOL列の行を抽出
matched_rows <- glydip_info[glydip_info$SYMBOL %in% common_symbols, ]

# 結果をCSVファイルに保存
write.csv(matched_rows, "Matched_GlyDIP_DE_info.csv", row.names = FALSE)

# 抽出結果の確認
print(head(matched_rows))  # 抽出したデータの先頭行を表示
print(paste("Number of matched rows:", nrow(matched_rows)))

```

